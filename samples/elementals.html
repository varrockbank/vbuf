<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>buffee - Elementals</title>
  <script src="../buffee.js"></script>
  <script src="../extensions/elementals.js"></script>
  <link rel="stylesheet" href="../reset.css">
  <link rel="stylesheet" href="../style.css">
  <style>
    /* Elementals styling */
    .wb-elemental-button {
      background-color: #3a3f4b;
      color: #eaeaea;
      padding: 2px 8px;
      border: 1px solid #555;
      border-radius: 3px;
    }
    .wb-elemental-button:hover {
      background-color: #4a4f5b;
      border-color: #777;
    }
    .wb-elemental-focused .wb-elemental-button {
      outline: 2px solid #EDAD10;
      outline-offset: 1px;
    }
    .wb-elemental-label { color: #888; }
    .wb-elemental-input {
      background-color: #1a1d23 !important;
      border-color: #555 !important;
    }
    .wb-elemental-input:focus {
      outline: 2px solid #EDAD10;
      outline-offset: -1px;
    }
    .wb-elemental-focused .wb-elemental-input {
      border-color: #EDAD10 !important;
    }

  </style>
</head>
<body class="sample">
  <nav id="nav"></nav>
  <script>
    fetch('../navigation.html')
      .then(r => r.text())
      .then(html => document.getElementById('nav').innerHTML = html);
  </script>
  <p><a href="../index.html">home</a> / <a href="index.html">samples</a> / Elementals</p>

  <h1>Elementals - Layer-based UI</h1>
  <p>Unlike tui-legacy which manipulates text content, Elementals creates actual DOM elements in a layer above the text.</p>
  <p>Press <kbd>Tab</kbd> to navigate, <kbd>Enter</kbd> to activate</p>

  <h2>Buttons</h2>
  <pre>BuffeeElementals(editor)
editor.Elementals.addButton({ row: 1, col: 5, label: 'Click Me' })</pre>
  <blockquote class="wb no-select" tabindex="0" id="buttons-demo" style="border: 1px solid #444; width: 600px;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="wb-content">
      <div class="wb-gutter"></div>
      <div class="wb-lines" style="flex: 1;"><div class="wb-layer-text"></div><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status" style="display: flex; justify-content: space-between; ">
      <div><span class="wb-linecount"></span></div>
      <div style="display: flex;">
        <span class="wb-coordinate"></span>|
        
        <span class="wb-indentation"></span>
      </div>
    </div>
  </blockquote>

  <h2>Input Fields</h2>
  <pre>Elementals.addInput({ row: 2, col: 10, width: 20, placeholder: 'Type here...' })</pre>
  <blockquote class="wb no-select" tabindex="0" id="inputs-demo" style="border: 1px solid #444; width: 600px;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="wb-content">
      <div class="wb-gutter"></div>
      <div class="wb-lines" style="flex: 1;"><div class="wb-layer-text"></div><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status" style="display: flex; justify-content: space-between; ">
      <div><span class="wb-linecount"></span></div>
      <div style="display: flex;">
        <span class="wb-coordinate"></span>|
        
        <span class="wb-indentation"></span>
      </div>
    </div>
  </blockquote>

  <h2>Mixed Elements</h2>
  <p>Combining labels, inputs, and buttons</p>
  <blockquote class="wb no-select" tabindex="0" id="mixed-demo" style="border: 1px solid #444; width: 600px;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="wb-content">
      <div class="wb-gutter"></div>
      <div class="wb-lines" style="flex: 1;"><div class="wb-layer-text"></div><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status" style="display: flex; justify-content: space-between; ">
      <div><span class="wb-linecount"></span></div>
      <div style="display: flex;">
        <span class="wb-coordinate"></span>|
        
        <span class="wb-indentation"></span>
      </div>
    </div>
  </blockquote>

  <script>

    // Buttons demo
    const buttonsEl = document.getElementById('buttons-demo');
    const buttonsEditor = new Buffee(buttonsEl, {
      viewportRows: 5,
      showGutter: false,
    });
    BuffeeElementals(buttonsEditor);
    buttonsEditor.Model.text = '\n\n\n\n';
    buttonsEditor.Elementals.addButton({
      row: 1, col: 2,
      label: 'Save',
      onActivate: () => { alert('Save clicked!'); }
    });
    buttonsEditor.Elementals.addButton({
      row: 1, col: 12,
      label: 'Load',
      onActivate: () => { alert('Load clicked!'); }
    });
    buttonsEditor.Elementals.addButton({
      row: 1, col: 22,
      label: 'Cancel',
      onActivate: () => { alert('Cancel clicked!'); }
    });
    buttonsEditor.Elementals.addButton({
      row: 3, col: 2,
      label: 'Delete',
      onActivate: () => { alert('Delete clicked!'); }
    });
    buttonsEditor.Elementals.enabled = true;
    buttonsEl.addEventListener('keydown', (e) => {
      if (e.key === 'Tab') {
        e.preventDefault();
        buttonsEditor.Elementals.nextElement();
      } else if (e.key === 'Enter') {
        e.preventDefault();
        buttonsEditor.Elementals.activateFocused();
      }
    });

    // Inputs demo
    const inputsEl = document.getElementById('inputs-demo');
    const inputsEditor = new Buffee(inputsEl, {
      viewportRows: 5,
      showGutter: false,
    });
    BuffeeElementals(inputsEditor);
    inputsEditor.Model.text = '\n\n\n\n';
    inputsEditor.Elementals.addLabel({ row: 1, col: 2, text: 'Name:' });
    inputsEditor.Elementals.addInput({
      row: 1, col: 9,
      width: 20,
      placeholder: 'Enter name',
      onSubmit: (el) => { alert('Name submitted: ' + el.value); }
    });
    inputsEditor.Elementals.addLabel({ row: 3, col: 2, text: 'Email:' });
    inputsEditor.Elementals.addInput({
      row: 3, col: 9,
      width: 25,
      placeholder: 'Enter email',
      onSubmit: (el) => { alert('Email submitted: ' + el.value); }
    });
    inputsEditor.Elementals.enabled = true;
    inputsEl.addEventListener('keydown', (e) => {
      if (e.key === 'Tab' && !e.target.matches('input')) {
        e.preventDefault();
        inputsEditor.Elementals.nextElement();
      }
    });

    // Mixed demo
    const mixedEl = document.getElementById('mixed-demo');
    const mixedEditor = new Buffee(mixedEl, {
      viewportRows: 8,
      showGutter: false,
    });
    BuffeeElementals(mixedEditor);
    mixedEditor.Model.text = '\n\n\n\n\n\n\n';

    // Form layout
    mixedEditor.Elementals.addLabel({ row: 1, col: 2, text: 'Search:' });
    const searchInput = mixedEditor.Elementals.addInput({
      row: 1, col: 10,
      width: 30,
      placeholder: 'Enter search term',
      onSubmit: (el) => { alert('Searching for: ' + el.value); }
    });
    mixedEditor.Elementals.addButton({
      row: 1, col: 42,
      label: 'Go',
      onActivate: () => {
        const input = mixedEditor.Elementals.elements.find(e => e.type === 'input');
        alert('Searching for: ' + (input ? input.value : ''));
      }
    });

    mixedEditor.Elementals.addLabel({ row: 4, col: 2, text: 'Options:' });
    mixedEditor.Elementals.addButton({
      row: 4, col: 12,
      label: 'Settings',
      onActivate: () => { alert('Settings opened'); }
    });
    mixedEditor.Elementals.addButton({
      row: 4, col: 26,
      label: 'Help',
      onActivate: () => { alert('Help opened'); }
    });
    mixedEditor.Elementals.addButton({
      row: 4, col: 36,
      label: 'About',
      onActivate: () => { alert('About dialog'); }
    });

    mixedEditor.Elementals.addButton({
      row: 6, col: 2,
      label: 'Submit Form',
      onActivate: () => {
        const input = mixedEditor.Elementals.elements.find(e => e.type === 'input');
        alert('Form submitted with: ' + (input ? input.value : ''));
      }
    });
    mixedEditor.Elementals.addButton({
      row: 6, col: 20,
      label: 'Reset',
      onActivate: () => {
        const input = mixedEditor.Elementals.elements.find(e => e.type === 'input');
        if (input) input.value = '';
        alert('Form reset');
      }
    });

    mixedEditor.Elementals.enabled = true;
    mixedEl.addEventListener('keydown', (e) => {
      if (e.key === 'Tab' && !e.target.matches('input')) {
        e.preventDefault();
        if (e.shiftKey) {
          mixedEditor.Elementals.prevElement();
        } else {
          mixedEditor.Elementals.nextElement();
        }
      } else if (e.key === 'Enter' && !e.target.matches('input')) {
        e.preventDefault();
        mixedEditor.Elementals.activateFocused();
      }
    });

    // Focus first editor
    buttonsEl.focus();
  </script>
</body>
</html>

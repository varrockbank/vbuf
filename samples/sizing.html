<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>buffee - Editor Sizing</title>
  <script src="../buffee.js"></script>
  <script src="../extensions/callbacks.js"></script>
  <link rel="stylesheet" href="../reset.css">
  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="../themes/boring.css">
  <style>
    .wb { font-size: 24px; }
  </style>
</head>
<body class="sample">
  <nav id="nav"></nav>
  <script>
    fetch('../navigation.html')
      .then(r => r.text())
      .then(html => document.getElementById('nav').innerHTML = html);
  </script>
  <p><a href="../index.html">home</a> / <a href="index.html">samples</a> / Editor Sizing</p>

  <h1>Editor Sizing</h1>
  <p>By default, the editor auto-fits to its container. Use <code>viewportRows</code> to fix the number of visible rows.</p>

  <h2>1. Auto-rows, auto-cols (recommended)</h2>
  <p><code>.wb { width: 960px; height: 300px; padding: 20px; }</code></p>
  <p><code>new Buffee(el, {})</code></p>
  <p>Default behavior: auto-fit rows and cols. Drag bottom-right to resize.</p>
  <div class="wb buffee-themepack1 boring" id="editor-auto-both" style="width: 960px; height: 300px; padding: 20px; border: 2px dashed #666; resize: both; overflow: hidden;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="no-select wb-elements">
      <div class="wb-gutter"></div>
      <div class="wb-lines" tabindex="0"><blockquote class="wb-layer-text"></blockquote><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status">
      <div class="wb-status-left"><span class="wb-linecount"></span></div>
      <div class="wb-status-right">
        Ln <span class="wb-head-row"></span>, Col <span class="wb-head-col"></span>
        <span class="wb-status-divider">|</span>
        <span class="wb-indentation"></span>
      </div>
    </div>
  </div>

  <h2>2. Fixed-rows, auto-cols</h2>
  <p><code>.wb { width: 640px; padding: 20px; }</code></p>
  <p><code>new Buffee(el, { viewportRows: 8 })</code></p>
  <p>Fixed 8 rows, columns auto-calculated from width. Drag to resize width.</p>
  <div class="wb buffee-themepack1 boring" id="editor-fixed-rows-auto-cols" style="width: 640px; padding: 20px; border: 2px dashed #666; resize: horizontal; overflow: hidden;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="no-select wb-elements">
      <div class="wb-gutter"></div>
      <div class="wb-lines" tabindex="0"><blockquote class="wb-layer-text"></blockquote><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status">
      <div class="wb-status-left"><span class="wb-linecount"></span></div>
      <div class="wb-status-right">
        Ln <span class="wb-head-row"></span>, Col <span class="wb-head-col"></span>
        <span class="wb-status-divider">|</span>
        <span class="wb-indentation"></span>
      </div>
    </div>
  </div>

  <h2>3. viewportRows smaller than container</h2>
  <p><code>.wb { height: 400px; padding: 20px; }</code></p>
  <p><code>new Buffee(el, { viewportRows: 5 })</code></p>
  <p>Container is 400px tall, but editor only shows 5 rows. viewportRows takes precedence instead of autofill remaining space.</p>
  <div class="wb buffee-themepack1 boring" id="editor-fixed-rows-large-container" style="height: 400px; padding: 20px; border: 2px solid #666;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="no-select wb-elements">
      <div class="wb-gutter"></div>
      <div class="wb-lines" tabindex="0"><blockquote class="wb-layer-text"></blockquote><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status">
      <div class="wb-status-left"><span class="wb-linecount"></span></div>
      <div class="wb-status-right">
        Ln <span class="wb-head-row"></span>, Col <span class="wb-head-col"></span>
        <span class="wb-status-divider">|</span>
        <span class="wb-indentation"></span>
      </div>
    </div>
  </div>

  <h2>4. viewportRows larger than container</h2>
  <p><code>.wb { height: 400px; padding: 20px; overflow: hidden; }</code></p>
  <p><code>new Buffee(el, { viewportRows: 20 })</code></p>
  <p>Container is 400px tall, but viewportRows requests 20 rows. Use <code>overflow: hidden</code> to clip.</p>
  <div class="wb buffee-themepack1 boring" id="editor-fixed-rows-overflow" style="height: 400px; padding: 20px; border: 2px solid #666; overflow: hidden;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="no-select wb-elements">
      <div class="wb-gutter"></div>
      <div class="wb-lines" tabindex="0"><blockquote class="wb-layer-text"></blockquote><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status">
      <div class="wb-status-left"><span class="wb-linecount"></span></div>
      <div class="wb-status-right">
        Ln <span class="wb-head-row"></span>, Col <span class="wb-head-col"></span>
        <span class="wb-status-divider">|</span>
        <span class="wb-indentation"></span>
      </div>
    </div>
  </div>

  <h2>5. viewportRows larger than container (scrollable)</h2>
  <p><code>.wb { height: 400px; padding: 20px; overflow: scroll; display: block; }</code></p>
  <p><code>new Buffee(el, { viewportRows: 20 })</code></p>
  <p>Container is 400px tall, but viewportRows requests 20 rows. Use <code>overflow: scroll</code> and <code>display: block</code> to scroll.</p>
  <div class="wb buffee-themepack1 boring" id="editor-fixed-rows-scroll" style="height: 400px; padding: 20px; border: 2px solid #666; overflow: scroll; display: block;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="no-select wb-elements">
      <div class="wb-gutter"></div>
      <div class="wb-lines" tabindex="0"><blockquote class="wb-layer-text"></blockquote><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status">
      <div class="wb-status-left"><span class="wb-linecount"></span></div>
      <div class="wb-status-right">
        Ln <span class="wb-head-row"></span>, Col <span class="wb-head-col"></span>
        <span class="wb-status-divider">|</span>
        <span class="wb-indentation"></span>
      </div>
    </div>
  </div>

  <h2>6. Auto-rows, fixed-cols (editor doesn't span full width of container, status line does)</h2>
  <p><code>.wb { height: 300px; padding: 20px; }</code></p>
  <p><code>new Buffee(el, { viewportCols: 55 })</code></p>
  <p>Fixed 40 columns, rows auto-calculated from height. Note: status bar stretches to container width while content is narrower.</p>
  <div class="wb buffee-themepack1 boring" id="editor-auto-rows-fixed-cols" style="height: 300px; padding: 20px; border: 2px dashed #666;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="no-select wb-elements">
      <div class="wb-gutter"></div>
      <div class="wb-lines" tabindex="0"><blockquote class="wb-layer-text"></blockquote><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status">
      <div class="wb-status-left"><span class="wb-linecount"></span></div>
      <div class="wb-status-right">
        Ln <span class="wb-head-row"></span>, Col <span class="wb-head-col"></span>
        <span class="wb-status-divider">|</span>
        <span class="wb-indentation"></span>
      </div>
    </div>
  </div>

  <h2>7. Auto-rows, fixed-cols (get container to shrink status line)</h2>
  <p><code>.wb { height: 300px; padding: 20px; width: fit-content; }</code></p>
  <p><code>new Buffee(el, { viewportCols: 55 })</code></p>
  <p>Same as example 6, but with <code>width: fit-content</code> so the container shrinks to match content width.</p>
  <div class="wb buffee-themepack1 boring" id="editor-fit-content" style="height: 300px; padding: 20px; border: 2px dashed #666; width: fit-content;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="no-select wb-elements">
      <div class="wb-gutter"></div>
      <div class="wb-lines" tabindex="0"><blockquote class="wb-layer-text"></blockquote><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status">
      <div class="wb-status-left"><span class="wb-linecount"></span></div>
      <div class="wb-status-right">
        Ln <span class="wb-head-row"></span>, Col <span class="wb-head-col"></span>
        <span class="wb-status-divider">|</span>
        <span class="wb-indentation"></span>
      </div>
    </div>
  </div>

  <h2>8. Auto-rows, fixed-cols (status line clipped)</h2>
  <p><code>.wb { height: 300px; padding: 20px; width: fit-content; }</code></p>
  <p><code>.wb-status { contain: inline-size; }</code></p>
  <p><code>new Buffee(el, { viewportCols: 20 })</code></p>
  <p>When <code>viewportCols</code> is small, status line content may be wider than editor. Use <code>contain: inline-size</code> on status bar to prevent its content from affecting <code>fit-content</code> calculation.</p>
  <div class="wb buffee-themepack1 boring" id="editor-example-8" style="height: 300px; padding: 20px; border: 2px dashed #666; width: fit-content;">
    <textarea class="wb-clipboard-bridge"></textarea>
    <div class="no-select wb-elements">
      <div class="wb-gutter"></div>
      <div class="wb-lines" tabindex="0"><blockquote class="wb-layer-text"></blockquote><div class="wb-layer-elements"></div><div class="wb-cursor"></div></div>
    </div>
    <div class="wb-status" style="contain: inline-size;">
      <div class="wb-status-left"><span class="wb-linecount"></span></div>
      <div class="wb-status-right">
        Ln <span class="wb-head-row"></span>, Col <span class="wb-head-col"></span>
        <span class="wb-status-divider">|</span>
        <span class="wb-indentation"></span>
      </div>
    </div>
  </div>

  <script>
    // Generate a ruler string: 01234567890123456789...
    function ruler(n) {
      let s = '';
      for (let i = 0; i < n; i++) s += i % 10;
      return s;
    }

    // 1. Auto-rows and auto-cols (default behavior)
    const elAutoBoth = document.getElementById('editor-auto-both');
    const edAutoBoth = new Buffee(elAutoBoth, {
      callbacks: BuffeeStatusLine(elAutoBoth)
    });
    edAutoBoth.Model.text = ruler(120) + '\n// Auto-rows and auto-cols\n// Drag corner to resize\n' +
      Array.from({length: 20}, (_, i) => `Line ${i + 4}`).join('\n');

    // 2. Fixed-rows, auto-cols
    const elFixedRowsAutoCols = document.getElementById('editor-fixed-rows-auto-cols');
    const edFixedRowsAutoCols = new Buffee(elFixedRowsAutoCols, {
      viewportRows: 8,
      callbacks: BuffeeStatusLine(elFixedRowsAutoCols)
    });
    edFixedRowsAutoCols.Model.text = ruler(120) + '\n// Fixed 8 rows, auto-cols\nLine 3\n' +
      Array.from({length: 20}, (_, i) => `Line ${i + 4}`).join('\n');

    // 3. viewportRows smaller than container
    const elFixedRowsLarge = document.getElementById('editor-fixed-rows-large-container');
    const edFixedRowsLarge = new Buffee(elFixedRowsLarge, {
      viewportRows: 5,
      callbacks: BuffeeStatusLine(elFixedRowsLarge)
    });
    edFixedRowsLarge.Model.text = ruler(80) + '\n// viewportRows: 5 overrides container height\n' +
      Array.from({length: 10}, (_, i) => `Line ${i + 3}`).join('\n');

    // 4. viewportRows larger than container
    const elFixedRowsOverflow = document.getElementById('editor-fixed-rows-overflow');
    const edFixedRowsOverflow = new Buffee(elFixedRowsOverflow, {
      viewportRows: 20,
      callbacks: BuffeeStatusLine(elFixedRowsOverflow)
    });
    edFixedRowsOverflow.Model.text = ruler(80) + '\n// viewportRows: 20 exceeds container height\n' +
      Array.from({length: 25}, (_, i) => `Line ${i + 3}`).join('\n');

    // 5. viewportRows larger than container (scrollable)
    const elFixedRowsScroll = document.getElementById('editor-fixed-rows-scroll');
    const edFixedRowsScroll = new Buffee(elFixedRowsScroll, {
      viewportRows: 20,
      callbacks: BuffeeStatusLine(elFixedRowsScroll)
    });
    edFixedRowsScroll.Model.text = ruler(80) + '\n// viewportRows: 20 exceeds container height\n// Scroll to see more\n' +
      Array.from({length: 25}, (_, i) => `Line ${i + 4}`).join('\n');

    // 6. Auto-rows, fixed-cols
    const elAutoRowsFixedCols = document.getElementById('editor-auto-rows-fixed-cols');
    const edAutoRowsFixedCols = new Buffee(elAutoRowsFixedCols, {
      viewportCols: 55,
      callbacks: BuffeeStatusLine(elAutoRowsFixedCols)
    });
    edAutoRowsFixedCols.Model.text = ruler(40) + '\n// Auto-rows, fixed 40 cols\n// Status bar stretches to container\n' +
      Array.from({length: 20}, (_, i) => `Line ${i + 4}`).join('\n');

    // 7. Auto-rows, fixed-cols (fit-content)
    const elFitContent = document.getElementById('editor-fit-content');
    const edFitContent = new Buffee(elFitContent, {
      viewportCols: 55,
      callbacks: BuffeeStatusLine(elFitContent)
    });
    edFitContent.Model.text = ruler(40) + '\n// Auto-rows, fixed 40 cols\n// width: fit-content\n' +
      Array.from({length: 20}, (_, i) => `Line ${i + 4}`).join('\n');

    // 8. Auto-rows, fixed-cols (status line clipped)
    const elExample8 = document.getElementById('editor-example-8');
    const edExample8 = new Buffee(elExample8, {
      viewportCols: 20,
      callbacks: BuffeeStatusLine(elExample8)
    });
    edExample8.Model.text = ruler(20) + '\n// Small viewportCols\n// Status clipped\n' +
      Array.from({length: 20}, (_, i) => `Line ${i + 4}`).join('\n');

  </script>
</body>
</html>
